---
- name: prepare cloud environment
  hosts: cloud-host

  roles:
    - { role: docker_filesystem, var_lib_docker: /dev/sdb }
    - { role: ansible-role-docker }
    - { role: docker }
    - { role: nextcloud }

    - role: monitor_http_vhost
      http_vhost_name: Cloud
      http_vhost_fqdn: "{{ cloud_vhost_fqdn }}"
      http_vhost_uri: "/login"
      http_vhost_string: "Forgot password"

    - role: monitor_tor_http_vhost
      with_https: false
      tor_http_vhost_name: Cloud over Tor
      tor_http_vhost_fqdn: "rjrdsaj4jemwrui6.onion"
      tor_http_vhost_uri: "/login"
      tor_http_vhost_string: "Forgot password"

  become: True
