object CheckCommand "tor_http" {
  import "http"
  vars.http_warning = 20
  vars.http_cricital = 25
  vars.http_timeout = 30
  command = [ "/usr/bin/torsocks", PluginDir + "/check_http" ]
}

apply Service for (tor_http_vhost => config in host.vars.tor_http_vhosts) {
  import "delayed-notification-service"

  check_command = "tor_http"
  vars.http_address = config.http_vhost
  command_endpoint = NodeName

  vars += config
}
