---
- name: install website
  hosts: website-host

  roles:
    - { role: website }

    - role: jdauphant.nginx
      vars:
        nginx_sites:
          default:
            - |
              listen 80;
              server_name {{ website_vhost_fqdn }};
              server_name www.{{ website_vhost_fqdn }};
              root /var/www/html/;
    - role: certbot
      vars:
        vhost_fqdn: "{{ website_vhost_fqdn }},www.{{ website_vhost_fqdn }}"


    - role: monitor_http_vhost
      http_vhost_name: Website
      http_vhost_fqdn: "{{ website_vhost_fqdn }}"
      http_vhost_uri: "/"
      http_vhost_string: "Enough"

  become: True
