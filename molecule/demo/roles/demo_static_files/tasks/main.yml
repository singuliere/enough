---

- name: create /var/www/{{ demo_name }}
  file:
    path: "/var/www/{{ demo_name }}"
    state: directory
    owner: www-data
    mode: 0755

- name: copy static files
  copy:
    src: "files/{{ item }}"
    dest: "/var/www/{{ demo_name }}"
    owner: www-data
  with_items:
    - qr.png
    - test_journalist_key.sec
    - jsOTP.js
    - favicon.png
    - logo.png
    - source.css

- name: copy templated static files
  template:
    src: "templates/{{ item }}"
    dest: "/var/www/{{ demo_name }}"
    owner: www-data
  with_items:
    - index.html
    - error.html
    - not_found.html

- name: copy code patches
  copy:
    src: "files/{{ item }}"
    dest: "/srv/securedrop/{{ demo_name }}"
  with_items:
    - 0001-demo-notice.patch
  become: false
