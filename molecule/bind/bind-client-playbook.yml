---
- name: setup DNS client
  hosts: [ 'all' ]
  become: True

  vars:
    domain: 'securedrop.club'

  roles:
    - role: Oefenweb.ansible-dns
      dns_nameservers: ['{{ hostvars["bind-host"]["ansible_host"] }}']
      dns_searches: ['{{ domain }}']
      dns_domain: '{{ domain }}'

  tasks:
    - name: set hostname
      hostname:
        name: '{{ inventory_hostname }}.{{ domain }}'
