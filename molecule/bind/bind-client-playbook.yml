---
- name: setup DNS client
  hosts: all:!external-host
  become: True

  roles:
    - role: dhclient
      dns_nameservers: ['{{ hostvars["bind-host"]["ansible_host"] }}']
      dns_search: "{{ domain }}"
      dns_domain: "{{ domain }}"

    - role: install_ssh_records
      vars:
        install_ssh_records_host: "{{ ansible_hostname }}"
        install_ssh_records_port: "{{ ansible_port }}"

  tasks:
    - name: set hostname
      hostname:
        name: '{{ inventory_hostname }}.{{ domain }}'
