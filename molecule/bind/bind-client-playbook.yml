---
- name: setup DNS client
  hosts: [ 'all' ]
  become: True

  roles:
    - role: dhclient
      dns_nameservers: ['{{ hostvars["bind-host"]["ansible_host"] }}']
      dns_search: "{{ domain }}"
      dns_domain: "{{ domain }}"
      nameservers_statement: "{% if with_fake_LE is defined or with_https is undefined %}supersede{% else %}prepend{% endif %}"

  tasks:
    - name: set hostname
      hostname:
        name: '{{ inventory_hostname }}.{{ domain }}'
