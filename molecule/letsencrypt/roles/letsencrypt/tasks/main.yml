---
- name: Create /usr/local/share/ca-certificates/infrastructure when fake LE certs are used
  file:
    path: /usr/local/share/ca-certificates/infrastructure
    state: directory
    owner: root
    group: root
    mode: 0755
  notify: update-ca-certificates
  when: letsencrypt_staging | default(false)

- name: upload fake LE certs
  copy:
    src: "files/certs/{{ item }}"
    dest: "/usr/local/share/ca-certificates/infrastructure/{{ item | replace('.pem', '.crt') }}"
    owner: root
    group: root
    mode: 0644
  loop: "{{ letsencrypt_fake_le_certs }}"
  notify: update-ca-certificates
  when: letsencrypt_staging | default(false)
