apply Service "Mail queue" {
  import "generic-service"

  check_command = "mailq"
  vars.mailq_warning = 20
  vars.mailq_critical = 40
  command_endpoint = host.vars.client_endpoint

  assign where host.vars.sendmail
}

apply Service "Process Postfix Master" {
  import "generic-service"

  check_command = "procs"
  command_endpoint = host.vars.client_endpoint

  vars.procs_command = "master"
  vars.procs_critical = "1:1"

  assign where host.vars.sendmail
}

apply Service "Check mailname" {
  import "generic-service"

  check_command = "grep"
  command_endpoint = host.vars.client_endpoint

  vars.pattern = "^mail.securedrop.club$$"
  vars.file = "/etc/mailname"

  assign where host.vars.sendmail
}
